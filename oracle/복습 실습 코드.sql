--125p Q1.

SELECT *
FROM EMP
WHERE ENAME LIKE '%S';

--Q2.

SELECT EMPNO, ENAME, JOB, SAL, DEPTNO
FROM EMP
WHERE JOB = 'SALESMAN';

--03.
-- 집합 연산자를 사용하지 않은 방식
SELECT EMPNO, ENAME, JOB, SAL, DEPTNO
FROM EMP
WHERE DEPTNO IN(20,30) AND SAL>2000;

-- 집합 연산자를 사용한 방식
SELECT EMPNO, ENAME, JOB, SAL, DEPTNO
FROM EMP
WHERE DEPTNO = 20 AND SAL>2000

UNION

SELECT EMPNO, ENAME, JOB, SAL, DEPTNO
FROM EMP
WHERE DEPTNO = 30 AND SAL>2000;

--Q4.

 SELECT *
 FROM EMP 
 WHERE SAL NOT BETWEEN 2000 AND 3000;

--Q5. 

SELECT ENAME, EMPNO, SAL, DEPTNO
FROM EMP
WHERE ENAME LIKE '%E%' 
  AND DEPTNO = 30
  AND SAL NOT BETWEEN 1000 AND 2000;


--Q6

 SELECT *
 FROM EMP
 WHERE COMM IS NULL
 AND MGR IS NOT NULL
 AND JOB IN('MANAGER','CLERK')
 AND ENAME NOT LIKE '_L%';
 
 
 -- TEST ZONE
 
 SELECT JOB, SUBSTR(JOB,1,2), SUBSTR(JOB,3,2), SUBSTR(JOB,5)
FROM EMP;



SELECT *
FROM EMP
WHERE INSTR(ENAME,'S') > 0;

SELECT ROUND(1234.5678) AS ROUND,
    ROUND(1234.5678, 0) AS ROUND_0,
    ROUND(1234.5678, 1) AS ROUND_1,
    ROUND(1234.5678, 2) AS ROUND_2,
    ROUND(1234.5678, -1) AS ROUND_MINUS1,
    ROUND(1234.5678, -2) AS ROUND_MINUS2
FROM DUAL;


SELECT *
FROM EMP
WHERE SAL BETWEEN 1250 AND 1500;

DESC EMP;

SELECT HIREDATE
FROM EMP;


SELECT '100,000' - '50,000'
FROM DUAL;

SELECT SUM(SAL) AS 급여총액,
       AVG(SAL) AS 급여평균,
       MAX(SAL) AS 최대급여,
       MIN(SAL) AS 최소급여
FROM EMP;

SELECT COUNT(*)
FROM EMP;

SELECT JOB
FROM EMP;


SELECT JOB
FROM EMP
ORDER BY JOB;

SELECT COUNT(JOB)
FROM EMP;

SELECT COUNT(DISTINCT JOB) AS "직업 종류의 개수"
FROM EMP;

SELECT ENAME, MAX(SAL)
FROM EMP;

SELECT AVG(SAL), '222' AS DEPTNO
FROM EMP
WHERE DEPTNO = 10
UNION ALL
SELECT AVG(SAL), '20' AS DEPTNO
FROM EMP
WHERE DEPTNO = 20
UNION ALL
SELECT AVG(SAL), '30' AS DEPTNO
FROM EMP
WHERE DEPTNO = 30;


SELECT AVG(SAL),DEPTNO
FROM EMP
GROUP BY DEPTNO;


SELECT DEPTNO, JOB, AVG(SAL)
FROM EMP
GROUP BY DEPTNO, JOB
ORDER BY DEPTNO, JOB;


SELECT DEPTNO, JOB, AVG(SAL)
FROM EMP
GROUP BY DEPTNO, JOB
HAVING AVG(SAL)>=2000;

SELECT DEPTNO, JOB, AVG(SAL)
FROM EMP
WHERE AVG(SAL) >= 2000
GROUP BY DEPTNO, JOB
ORDER BY DEPTNO, JOB;

SELECT ENAME, SAL
FROM EMP
WHERE SAL > AVG(SAL);  -- 오류: 집계 함수는 WHERE 절에서 사용할 수 없음


SELECT DEPTNO,ENAME, AVG(SAL)
FROM EMP
GROUP BY DEPTNO, ENAME;


SELECT DEPTNO,ENAME
FROM EMP
GROUP BY DEPTNO;

SELECT LISTAGG(ENAME, ' ')
WITHIN GROUP(ORDER BY SAL DESC)
FROM EMP;


SELECT E.EMPNO, E.ENAME, E.SAL, D.DEPTNO, D.DNAME, D.LOC
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
AND E.SAL >= 3000;


SELECT *
FROM EMP E, SALGRADE S
WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL;


SELECT E1.EMPNO, E1.ENAME, E1.MGR,
E2.EMPNO AS MGR_EMPNO,
E2.ENAME AS MGR_ENAME
FROM EMP E1 LEFT OUTER JOIN EMP E2 ON(E1.MGR=E2.EMPNO)
ORDER BY E1.EMPNO;

SELECT ENAME
FROM EMP
WHERE SAL > ALL (SELECT SAL FROM EMP WHERE DEPTNO = 30);

SELECT ENAME
FROM EMP
WHERE SAL > SOME (SELECT SAL FROM EMP WHERE DEPTNO = 30);



-- ===================================

-- 사원 이름이 JONES인 사원의 급여 출력하기

SELECT SAL
FROM EMP
WHERE ENAME = 'JONES';

-- 급여가 2975보다 높은 사원 정보 출력하기

SELECT *
FROM EMP
WHERE SAL > 2975;

-- 서브쿼리로 JONES의 급여보다 높은 급여를 받는 사원 정보 출력하기

SELECT *
FROM EMP
WHERE SAL > (
	SELECT SAL
	FROM EMP
	WHERE ENAME = 'JONES');
    

-- EMP 테이블에서 SCOTT보다 빨리 입사한 사원 목록 출력하기

SELECT *
FROM EMP
WHERE HIREDATE > (
	SELECT HIREDATE
	FROM EMP
	WHERE ENAME = 'SCOTT');

-- 20번 부서에 속한 사원 중 전체 사원의 
-- 평균 급여보다 높은 급여를 받는 사원 
-- 정보와 소속 부서 정보를 출력하기

SELECT *
FROM EMP
WHERE DEPTNO = 20
AND SAL > (
	SELECT AVG(SAL)
	FROM EMP);

SELECT *
FROM EMP
WHERE DEPTNO = 20
AND  SAL > (
    SELECT AVG(SAL)
    FROM EMP
);


SELECT E.EMPNO, E.ENAME, E.JOB, E.SAL, D.DEPTNO, D.DNAME, D.LOC
FROM EMP E, DEPT D
WHERE E.DEPTNO = 20
    AND E.DEPTNO = D.DEPTNO
    AND  SAL > (
        SELECT AVG(SAL)
        FROM EMP
    );

-- IN 연산자 사용하기
-- 부서 번호가 20이거나 30인 사원의 정보를 출력하기

SELECT *
FROM EMP
WHERE DEPTNO IN(20,30);

-- 각 부서별 최고 급여와 동일한 급여를 받는 사원 정보 출력하기

SELECT *
FROM EMP
WHERE SAL in(
	SELECT MAX(SAL)
	FROM EMP
    GROUP BY DEPTNO
    );
    
SELECT *
FROM EMP
WHERE SAL IN (
    SELECT MAX(SAL)
    FROM EMP
    GROUP BY DEPTNO
);    

-- ANY 연산자 사용하기
-- 각 부서별 최고 급여와 동일한 급여를 받는 사원 정보 출력하기

SELECT *
FROM EMP
WHERE SAL ANY(
	SELECT MAX(SAL)
	FROM EMP);

-- SOME 연산자 사용하기
-- 각 부서별 최고 급여와 동일한 급여를 받는 사원 정보 출력하기

SELECT *
FROM EMP
WHERE SAL in(
	SELECT SOME(SAL)
	FROM EMP);

-- 30번 부서 사원들의 최대 급여보다 적은 급여를 받는 사원 정보 출력하기

SELECT *
FROM EMP
WHERE SAL < (
	SELECT MAX(SAL)
	FROM EMP
	WHERE DEPTNO = 30);

-- 30번 부서 사원들의 최소 급여보다 많은 급여를 받는 사원 정보 출력하기

SELECT *
FROM EMP
WHERE SAL > (
	SELECT MIN(SAL)
	FROM EMP
	WHERE DEPTNO = 30);

-- 30번 부서 사원들의 최소 급여보다 더 적은 급여를 받는 사원 정보 출력하기

SELECT *
FROM EMP
WHERE SAL < (
	SELECT MIN(SAL)
	FROM EMP
	WHERE DEPTNO = 30);

-- 30번 부서 사원들의 최대 급여보다 더 많은 급여를 받는 사원 정보 출력하기

SELECT *
FROM EMP
WHERE SAL > (
	SELECT MAX(SAL)
	FROM EMP
	WHERE DEPTNO = 30);


SELECT *
FROM SALGRADE;

SELECT *
FROM EMP;

SELECT DEPTNO AS "부서 번호", AVG(SAL) AS "급여 평균"
FROM EMP;

SELECT DEPTNO AS "부서 번호", AVG(SAL) AS "급여 평균"
FROM EMP
GROUP BY DEPTNO;

-- 다중 컬럼을 이용하여 그룹별로 출력하기

SELECT DEPTNO, JOB, COUNT(*), SUM(SAL)
FROM EMP
GROUP BY DEPTNO, JOB
ORDER BY DEPTNO, JOB;

 SELECT JOB, SUM(SAL)
 FROM EMP
 WHERE NOT JOB = 'MANAGER'
 GROUP BY JOB
 HAVING SUM(SAL) >= 5000
 ORDER BY JOB;
 
 -- 부서별 평균 급여 중 최고 급여 출력하기

SELECT JOB, MAX(SAL)
FROM EMP
GROUP BY JOB
HAVING MAX(SAL);

-- 부서별 평균 급여 중 최고 급여 출력하기

SELECT MAX(AVG(SAL))
FROM EMP
GROUP BY DEPTNO;

-- Q4. 사원번호가 7788인 사원의 이름과 소속 부서명을 출력하기

SELECT E.ENAME, D.DNAME
FROM EMP E, DEPT D
WHERE E.EMPNO = 7788;

-- Q4. 사원번호가 7788인 사원의 이름과 소속 부서명을 출력하기

SELECT E.ENAME, D.DNAME
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
AND E.EMPNO = 7788;

-- Q5. 사원별로 급여 등급을 출력하기 (컬럼은 사원이름,급여,등급만 표시해주세요.)

SELECT E.ENAME, E.SAL, S.GRADE
FROM EMP E, SALGRADE S;

-- Q5. 사원별로 급여 등급을 출력하기 (컬럼은 사원이름,급여,등급만 표시해주세요.)

SELECT E.ENAME, E.SAL, S.GRADE
FROM EMP E, SALGRADE S
WHERE SAL BETWEEN LOSAL AND HISAL;

-- Q6. 사원의 이름과 소속된 부서의 이름과 급여, 급여가 몇 등급인지를 출력하기

SELECT E.ENAME, D.DNAME, E.SAL, S.GRADE
FROM EMP E, DEPT D, SALGRADE S
WHERE E.DEPTNO = D.DEPTNO
AND SAL BETWEEN LOSAL AND HISAL;

select e.ename, d.dname,e.sal, s.grade
from emp e, dept d, salgrade s
where e.deptno = d.deptno 
    and e.sal between s.losal and s.hisal;
    
    -- 사원이름과 직속 상관 이름을 출력하기

SELECT E1.ENAME, E2.ENAME
FROM EMP E1, EMP E2
WHERE E1.MGR = E2.EMPNO;

-- JION ~ ON절을 사용하여 출력하기
SELECT  E1.ENAME || '의 직속 상관은 ' || E2.ENAME
FROM EMP E1 JOIN EMP E2 ON E1.MGR = E2.EMPNO;

-- Q12. 직급이 SALESMAN 이 아니면서 급여가 임의의 SALESMAN 보다 
--급여가 낮은 사원의 사원번호,이름,직급,급여를 출력하기

SELECT EMPNO, ENAME, JOB, SAL
FROM EMP
WHERE JOB != 'SALESMAN'
AND SAL < (
	SELECT SAL
	FROM EMP
	WHERE JOB = 'SALESMAN'
	);
    
    -- Q12. 직급이 SALESMAN 이 아니면서 급여가 임의의 SALESMAN 보다 
--급여가 낮은 사원의 사원번호,이름,직급,급여를 출력하기

SELECT EMPNO, ENAME, JOB, SAL
FROM EMP
WHERE JOB != 'SALESMAN'
AND SAL < ANY(
	SELECT SAL
	FROM EMP
	WHERE JOB = 'SALESMAN'
	);
    
    -- 서브쿼리 결과 값이 존재하지 않는 경우
SELECT *
FROM EMP
WHERE EXISTS (
    SELECT DNAME
    FROM DEPT
    WHERE DEPTNO = 50
);  





-- 복습 코딩 테스트

--Q1.

SELECT *
FROM EMP
WHERE SAL>=1500;

SELECT *
FROM EMP
WHERE NOT SAL <1500;

--Q2.

SELECT *
FROM EMP
WHERE DEPTNO = 10;

SELECT *
FROM EMP
WHERE DEPTNO NOT IN(20,30);

SELECT *
FROM EMP
WHERE DEPTNO !=20
AND DEPTNO !=30;

SELECT *
FROM EMP
WHERE EMPNO IN (
    SELECT EMPNO 
    FROM EMP 
    WHERE DEPTNO NOT IN (20, 30)
);

SELECT *
FROM EMP
WHERE CASE 
          WHEN DEPTNO = 10 THEN 1 
          ELSE 0
      END = 1;
      
SELECT *
FROM EMP
WHERE DEPTNO IN(10);

--Q3.

SELECT *
FROM EMP
WHERE ENAME = 'SCOTT';

SELECT *
FROM EMP
WHERE ENAME LIKE 'SCOTT';

--Q4.

SELECT *
FROM EMP
WHERE HIREDATE <= DATE '1981-01-01';

SELECT *
FROM EMP
WHERE HIREDATE BETWEEN DATE '1900-01-01' AND DATE '1981-01-01';

SELECT *
FROM EMP
WHERE HIREDATE <= TO_DATE('1981-01-01', 'YYYY-MM-DD');

--Q5

SELECT *
FROM EMP
WHERE DEPTNO = 10 
AND JOB = 'MANAGER';

--Q6

SELECT *
FROM EMP
WHERE DEPTNO = 10 
OR JOB = 'MANAGER';

--Q7

SELECT *
FROM EMP
WHERE DEPTNO != 10;

SELECT *
FROM EMP
WHERE DEPTNO <> 10;

SELECT *
FROM EMP
WHERE DEPTNO ^= 10;

--Q8

SELECT *
FROM EMP
WHERE SAL >= 1000
AND SAL<=1500
ORDER BY EMPNO;


SELECT *
FROM EMP
WHERE SAL BETWEEN 1000 AND 1500
ORDER BY EMPNO;

--Q9

SELECT *
FROM EMP
WHERE SAL < 1000
OR SAL >1500
ORDER or EMPNO;

SELECT *
FROM EMP
WHERE SAL NOT BETWEEN 1000 AND 1500
ORDER BY EMPNO;

SELECT *
FROM EMP
WHERE SAL < 1000
UNION
SELECT *
FROM EMP
WHERE SAL > 1500
ORDER BY EMPNO;

--Q10

SELECT *
FROM EMP
WHERE COMM IN(300,500,1400);